
### 가정용 공유기의 문제
#### 1. 구조: 외부망 - 가정공유기(공인IP) - 내 컴퓨터(사설IP)
#### 2. 문제: 공유기의 공인 IP가 계속 변경되고, 공유기에 연결된 컴퓨터마다 별도의 사설IP가 부여된다.
#### 3. 해결: 포트포워딩, DDNS
> ##### IP가 한정되어 있기 때문에, 인터넷 제공업체(ISP 통신사)는 가정용 인터넷의 IP주소를 계속 바꾼다.(유동 IP)

<br>

### 포트?
#### : 모든 호스트(IP)는 60000개 정도의 문을 갖고 있는데, 이를 포트라고 한다.
#### : 즉, 하나의 IP에 접속할 때, 수많은 문(포트) 중 하나를 열고 들어가야 한다.
#### 1024번 포트까지는 특별한 용도로 사용되므로 임의 사용이 불가하다.
1. 80포트: 웹서버가 열어둔 문. dogumater.com 요청을하면 자동으로 해당 IP의 80포트 문으로 들어간다.
2. 20포트: ftp

<br>

### 포트 포워딩
#### : 공유기(공인IP)의 특정 포트(80 등)로 접근하면, 공유기에 연결된 ***특정 컴퓨터(사설IP)*** 의 ***특정 포트*** 로 접속하도록 설정하는 작업
> 공인IP:외부포트 -> 사설IP:내부포트 

<br>

### DDNS(Dynamic DNS)
#### : IP주소가 변경될 때 마다, 네임서버에서 도메인에 설정된 IP주소를 변경해주는 서비스

<br>

### localhost(127.0.0.1)
#### : 본인 컴퓨터에 접속하는 주소
#### : 참고로, hosts 파일에 localhost로 접속하면, 127.0.0.1 로 이동하라고 설정되어 있음

<br>

### IP 주소 확인 방법
1. 공유기의ip(공인ip)
    - 구글 등에서 my ip를 검색해서 나온 IP확인 사이트에 들어간다.
    - 공유기의 공인 IP주소가 나온다.
2. 공유기에 연결된 컴퓨터의 ip(사설 ip)
    - 터미널 상에서 `ipconfig` 등을 실행 후, IPv4 주소를 확인하면 된다.
    - 사설 IP는 공유기 세계에서만 작동하는 주소다.

<br>

### 포트 포워딩 방법
#### : 외부에서 공인ip의 특정 포트로 접속 시, 공유기에 연결된 특정 컴퓨터의 특정 포트로 연결(포워딩) 시키는 작업
1. 공유기 관리 사이트(http://192.168.35.1/)에 접속
2. ***고급설정 > NAT/라우터 관리 > 포트포워딩*** 에서 아래와 같이 설정한다.
3. 내부주소 설정
    - 공유기의 공인 ip로 접속시 연결할 컴퓨터의 ***사설 ip*** 지정
    - ***고급설정 > 네트워크관리 > 접속단말정보*** 로 접근하여 특정 컴퓨터의 사설 ip를 확인할 수 있다.
4. 프로토콜 설정
    - TCP로 설정
5. 외부포트 설정
    - 공유기의 공인 ip의 ***몇번 포트*** 로 접속했을 때 포트포워딩 할지 지정
    - 상용으로 쓰려면, 80~80을 입력하고, 개발용이라면 다른거 아무거나.(외부 접속 시, 공인ip:외부포트 로 접근 가능하다)
6. 내부포트 설정
    - 특정 컴퓨터의 사설ip의 ***몇번 포트*** 로 접속하게 할지 지정
    - 내 웹서버에서 열어둔 포트(50001~50001 등)를 입력
##### 그러나, 공인 ip가 계속 바뀌므로 DDNS 등을 통해 도메인에 설정된 공인ip주소를 계속 변경해주어야 한다.
##### 공유기에서 특정 도메인과 DDNS 기능을 제공해주기도 한다.(iptime은 자체 네임서버를 통해 iptime 도메인에 설정하고, ip주소를 수시로 체크하여 변경해주는 기능을 제공.)
##### 이 경우, 내 도메인을 공유기의 도메인으로 포워딩하도록 네임서버에 설정해주면 된다.
